@page "/"
@inject testing_final.Logic.Models.Cart CartService

<h1>iPhone World</h1>
<p>Cheapest Iphones with Free Shipping! Add products to your cart by clicking the "Add" button.</p>

<div class="product-grid">
    @foreach (var product in ProductCatalog.Products)
    {
        <div class="product-card">
            <img src="@GetProductImage(product.Name)" alt="@product.Name" />
            <h3>@product.Name</h3>
            <p>$@product.Price</p> <!-- Changed to display with $ prefix -->

            <div class="product-actions">
                <button @onclick="() => AddToCart(product)">Add</button>
                <span>Qty: @GetQuantityInCart(product.Name)</span>
            </div>
        </div>
    }
</div>

@code {
    private void AddToCart(Item product)
    {
        CartService.AddItem(product);
    }

    private int GetQuantityInCart(string productName)
    {
        var item = CartService.Items.FirstOrDefault(i => i.Name == productName);
        return item?.Quantity ?? 0;
    }

    private string GetProductImage(string productName)
    {
        return $"/images/{productName.ToLower().Replace(" ", "-")}.jpg";
    }
}
